<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Doxygen Fortran Example: control_variables.f90 Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Modules</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
<h1>control_variables.f90</h1><a href="control__variables_8f90.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">!******************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment">! Module containing global variables for test_cases.f90 as well as allocation</span>
<a name="l00003"></a>00003 <span class="comment">! and deallocation routines</span>
<a name="l00004"></a>00004 <span class="comment">!******************************************************************************</span>
<a name="l00005"></a>00005 <span class="comment">! REQUIRED FILES:</span>
<a name="l00006"></a>00006 <span class="comment">! PRECISION_VARS.F90            *DEFINES PRECISION FOR ALL VARIABLES</span>
<a name="l00007"></a>00007 <span class="comment">! SBP_COEF_MODULE.F90       *DEFINES CSR DERIVATIVE OPERATORS</span>
<a name="l00008"></a>00008 <span class="comment">!******************************************************************************</span>
<a name="l00009"></a>00009 
<a name="l00010"></a><a class="code" href="namespacecontrol__variables.html">00010</a>       <span class="keyword">module</span> control_variables
<a name="l00011"></a>00011       
<a name="l00012"></a>00012       use <span class="keywordflow">precision_vars</span>, only : wp
<a name="l00013"></a>00013       
<a name="l00014"></a>00014       implicit none; <span class="keywordtype">save</span>
<a name="l00015"></a>00015       
<a name="l00016"></a>00016       <span class="keywordtype">private</span>
<a name="l00017"></a>00017       <span class="keywordtype">public</span> :: Temporal_splitting, <a class="code" href="namespacecontrol__variables.html#ab4dc4a4fa46d7037bf7d9aaa1ab3e81c">probname</a>, <a class="code" href="namespacecontrol__variables.html#a291e2e72b0a3f05b05ea09624acb6878">Jac_case</a>, <a class="code" href="namespacecontrol__variables.html#a38c0c84aed90e2c59f73b048e4a41950">isamp</a>,<a class="code" href="namespacecontrol__variables.html#a83d3754355c992827e338ffd1a151245">jmax</a>,<a class="code" href="namespacecontrol__variables.html#a979588abef01adfd5d2b6264c2dc6237">jactual</a>
<a name="l00018"></a>00018       <span class="keywordtype">public</span> :: <a class="code" href="namespacecontrol__variables.html#ad119e0e43b798a9df022f32defb2719c">tol</a>,<a class="code" href="namespacecontrol__variables.html#a0f46de603407763235065e0c61f181ff">dt_error_tol</a>
<a name="l00019"></a>00019       <span class="keywordtype">public</span> :: <a class="code" href="namespacecontrol__variables.html#af26d46d355bee6c749bf25537333f463">uvec</a>,<a class="code" href="namespacecontrol__variables.html#a3f01352de7c4bb4687c9af3b22110302">uexact</a>,<a class="code" href="namespacecontrol__variables.html#a1a8ae18f1306cb293f5d87041ad835e7">b</a>,<a class="code" href="namespacecontrol__variables.html#adb75fde9a143a0e98e889020a87a9f4c">usum</a>,<a class="code" href="namespacecontrol__variables.html#a6fad9568d55bd9d885c4c73fed5c332f">uveco</a>
<a name="l00020"></a>00020       <span class="keywordtype">public</span> :: <a class="code" href="namespacecontrol__variables.html#a4715913d9d9a458e7e453251143e30bb">errvec</a>,<a class="code" href="namespacecontrol__variables.html#af335d1c81000a57748875e5f45f335b3">errvecT</a>,<a class="code" href="namespacecontrol__variables.html#a564c7b023cbf232bf7d974084e240135">tmpvec</a>
<a name="l00021"></a>00021       <span class="keywordtype">public</span> :: <a class="code" href="namespacecontrol__variables.html#a9f7c2243d548ddee9248892603d7dcdc">resE</a>,<a class="code" href="namespacecontrol__variables.html#a622a60898014b0384693ee589b049bcc">resI</a>,<a class="code" href="namespacecontrol__variables.html#a154cb346d1fea6a9ff450290221ee0fe">error</a>,<a class="code" href="namespacecontrol__variables.html#a7522507cf8bc1f3a9330fdfa3afb8df6">errorP</a>,<a class="code" href="namespacecontrol__variables.html#afae70ecf2800b85b5556f11ef27e1083">xjac</a>
<a name="l00022"></a>00022       <span class="keywordtype">public</span> :: <a class="code" href="namespacecontrol__variables.html#ae67e7c71c7fbe553dbeab99d7d911445">b1save</a>,<a class="code" href="namespacecontrol__variables.html#adc716da32e194c8cb19ef9b13a8ee8ef">b1Psave</a>,<a class="code" href="namespacecontrol__variables.html#a70ee148b1d53c7eabd08208a05f0c5bb">ustage</a>,<a class="code" href="namespacecontrol__variables.html#a10062ed742cfed59b3bcc40ba9ba3f1e">predvec</a> 
<a name="l00023"></a>00023       <span class="keywordtype">public</span> :: <a class="code" href="namespacecontrol__variables.html#a78bc09bea8f6f302b104ee7ce7d1ad55">allocate_vars</a>,<a class="code" href="namespacecontrol__variables.html#a9cf138262bc4c7548a3dbaf509edc947">deallocate_vars</a>
<a name="l00024"></a>00024       <span class="keywordtype">public</span> :: <a class="code" href="namespacecontrol__variables.html#a3fa12a567e9193bb18550fbe37751642">programstep</a>
<a name="l00025"></a>00025 <span class="comment">!--------------------------VARIABLES-------------------------------------------</span>
<a name="l00026"></a><a class="code" href="namespacecontrol__variables.html#acddb29889ae54184c75bea993f2e153f">00026</a>       <span class="keywordtype">character(len=80)</span>, <span class="keywordtype">parameter</span> :: Temporal_Splitting = <span class="stringliteral">&apos;IMEX&apos;</span>
<a name="l00027"></a>00027 <span class="comment">!      character(len=80), parameter :: Temporal_Splitting = &apos;IMPLICIT&apos; </span>
<a name="l00028"></a>00028 <span class="comment">!      character(len=80), parameter :: Temporal_Splitting = &apos;EXPLICIT&apos;</span>
<a name="l00029"></a><a class="code" href="namespacecontrol__variables.html#ab4dc4a4fa46d7037bf7d9aaa1ab3e81c">00029</a>       <span class="keywordtype">character(len=9)             </span>:: probname
<a name="l00030"></a><a class="code" href="namespacecontrol__variables.html#a291e2e72b0a3f05b05ea09624acb6878">00030</a>       <span class="keywordtype">character(len=6)             </span>:: Jac_case=<span class="stringliteral">&apos;DENSE&apos;</span> <span class="comment">!default value</span>
<a name="l00031"></a><a class="code" href="namespacecontrol__variables.html#a3fa12a567e9193bb18550fbe37751642">00031</a>       <span class="keywordtype">character(len=80)            </span>:: programstep
<a name="l00032"></a><a class="code" href="namespacecontrol__variables.html#a38c0c84aed90e2c59f73b048e4a41950">00032</a>       <span class="keywordtype">integer</span>, <span class="keywordtype">parameter</span>           :: isamp=71   
<a name="l00033"></a><a class="code" href="namespacecontrol__variables.html#a83d3754355c992827e338ffd1a151245">00033</a>       <span class="keywordtype">integer</span>, <span class="keywordtype">parameter</span>           :: jmax=81     
<a name="l00034"></a><a class="code" href="namespacecontrol__variables.html#a979588abef01adfd5d2b6264c2dc6237">00034</a>       <span class="keywordtype">integer</span>, <span class="keywordtype">parameter</span>           :: jactual=81     
<a name="l00035"></a>00035       
<a name="l00036"></a><a class="code" href="namespacecontrol__variables.html#ad119e0e43b798a9df022f32defb2719c">00036</a>       <span class="keywordtype">real(wp) </span>:: tol,dt_error_tol
<a name="l00037"></a>00037 
<a name="l00038"></a><a class="code" href="namespacecontrol__variables.html#a6fad9568d55bd9d885c4c73fed5c332f">00038</a>       <span class="keywordtype">real(wp)</span>, <span class="keywordtype">dimension(:)</span>,   <span class="keywordtype">ALLOCATABLE</span> :: uvec,uexact,b,usum,uveco
<a name="l00039"></a><a class="code" href="namespacecontrol__variables.html#a564c7b023cbf232bf7d974084e240135">00039</a>       <span class="keywordtype">real(wp)</span>, <span class="keywordtype">dimension(:)</span>,   <span class="keywordtype">allocatable</span> :: errvec,errvecT,tmpvec
<a name="l00040"></a><a class="code" href="namespacecontrol__variables.html#afae70ecf2800b85b5556f11ef27e1083">00040</a>       <span class="keywordtype">real(wp)</span>, <span class="keywordtype">dimension(:,:)</span>, <span class="keywordtype">allocatable</span> :: resE,resI,error,errorP,xjac
<a name="l00041"></a><a class="code" href="namespacecontrol__variables.html#a70ee148b1d53c7eabd08208a05f0c5bb">00041</a>       <span class="keywordtype">real(wp)</span>, <span class="keywordtype">dimension(:,:)</span>, <span class="keywordtype">allocatable</span> :: b1save,b1Psave,ustage,predvec
<a name="l00042"></a>00042       
<a name="l00043"></a>00043 <span class="comment">!------------------------------------------------------------------------------</span>
<a name="l00044"></a>00044  
<a name="l00045"></a>00045       <span class="keyword">contains</span>
<a name="l00046"></a>00046 
<a name="l00047"></a>00047 <span class="comment">!==============================================================================</span>
<a name="l00048"></a>00048 <span class="comment">! ALLOCATE GLOBAL VARIABLES</span>
<a name="l00049"></a><a class="code" href="namespacecontrol__variables.html#a78bc09bea8f6f302b104ee7ce7d1ad55">00049</a>       <span class="keyword">subroutine </span><a class="code" href="namespacecontrol__variables.html#a78bc09bea8f6f302b104ee7ce7d1ad55">allocate_vars</a>(nveclen,is)
<a name="l00050"></a>00050       
<a name="l00051"></a>00051       <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: nveclen,is
<a name="l00052"></a>00052       
<a name="l00053"></a>00053       <span class="comment">!**ALLOCATE VARIABLES**</span>
<a name="l00054"></a>00054       <span class="comment">!problemsub</span>
<a name="l00055"></a>00055       <span class="keyword">AllOCATE</span>(<a class="code" href="namespacecontrol__variables.html#af26d46d355bee6c749bf25537333f463">uvec</a>(nveclen),<a class="code" href="namespacecontrol__variables.html#a3f01352de7c4bb4687c9af3b22110302">uexact</a>(nveclen),<a class="code" href="namespacecontrol__variables.html#a9f7c2243d548ddee9248892603d7dcdc">resE</a>(nveclen,is),<a class="code" href="namespacecontrol__variables.html#a622a60898014b0384693ee589b049bcc">resI</a>(nveclen,is))
<a name="l00056"></a>00056    
<a name="l00057"></a>00057       <span class="comment">!data outs</span>
<a name="l00058"></a>00058       <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacecontrol__variables.html#a154cb346d1fea6a9ff450290221ee0fe">error</a>(<a class="code" href="namespacecontrol__variables.html#a38c0c84aed90e2c59f73b048e4a41950">isamp</a>,nveclen),<a class="code" href="namespacecontrol__variables.html#a7522507cf8bc1f3a9330fdfa3afb8df6">errorP</a>(<a class="code" href="namespacecontrol__variables.html#a38c0c84aed90e2c59f73b048e4a41950">isamp</a>,nveclen),<a class="code" href="namespacecontrol__variables.html#a1a8ae18f1306cb293f5d87041ad835e7">b</a>(nveclen*2))
<a name="l00059"></a>00059 
<a name="l00060"></a>00060       <span class="comment">!Newton_iteration</span>
<a name="l00061"></a>00061       <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacecontrol__variables.html#adb75fde9a143a0e98e889020a87a9f4c">usum</a>(nveclen),<a class="code" href="namespacecontrol__variables.html#afae70ecf2800b85b5556f11ef27e1083">xjac</a>(nveclen,nveclen))       
<a name="l00062"></a>00062 
<a name="l00063"></a>00063       <span class="comment">!internal</span>
<a name="l00064"></a>00064       <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacecontrol__variables.html#a70ee148b1d53c7eabd08208a05f0c5bb">ustage</a>(nveclen,is),<a class="code" href="namespacecontrol__variables.html#a10062ed742cfed59b3bcc40ba9ba3f1e">predvec</a>(nveclen,is),<a class="code" href="namespacecontrol__variables.html#a6fad9568d55bd9d885c4c73fed5c332f">uveco</a>(nveclen))
<a name="l00065"></a>00065       <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacecontrol__variables.html#a4715913d9d9a458e7e453251143e30bb">errvec</a>(nveclen),<a class="code" href="namespacecontrol__variables.html#af335d1c81000a57748875e5f45f335b3">errvecT</a>(nveclen),<a class="code" href="namespacecontrol__variables.html#a564c7b023cbf232bf7d974084e240135">tmpvec</a>(nveclen))
<a name="l00066"></a>00066       <span class="keyword">ALLOCATE</span>(<a class="code" href="namespacecontrol__variables.html#ae67e7c71c7fbe553dbeab99d7d911445">b1save</a>(<a class="code" href="namespacecontrol__variables.html#a83d3754355c992827e338ffd1a151245">jmax</a>,nveclen),<a class="code" href="namespacecontrol__variables.html#adc716da32e194c8cb19ef9b13a8ee8ef">b1Psave</a>(<a class="code" href="namespacecontrol__variables.html#a83d3754355c992827e338ffd1a151245">jmax</a>,nveclen))
<a name="l00067"></a>00067        
<a name="l00068"></a>00068 <span class="keyword">       end subroutine allocate_vars</span>
<a name="l00069"></a>00069      
<a name="l00070"></a>00070 <span class="comment">!==============================================================================</span>
<a name="l00071"></a>00071 <span class="comment">! DEALLOCATE GLOBAL VARIABLES</span>
<a name="l00072"></a><a class="code" href="namespacecontrol__variables.html#a9cf138262bc4c7548a3dbaf509edc947">00072</a>       <span class="keyword">subroutine </span><a class="code" href="namespacecontrol__variables.html#a9cf138262bc4c7548a3dbaf509edc947">deallocate_vars</a>()
<a name="l00073"></a>00073       
<a name="l00074"></a>00074       use <span class="keywordflow">SBP_Coef_Module</span>, only: Pmat,Pinv,iD1,jD1,D1,iD2,jD2,D2,D1_per,&amp;
<a name="l00075"></a>00075      &amp;                           iD1_per,jD1_per
<a name="l00076"></a>00076       
<a name="l00077"></a>00077       <span class="comment">!**DEALLOCATE VARIABLES**</span>
<a name="l00078"></a>00078       <span class="comment">!problemsub</span>
<a name="l00079"></a>00079       <span class="keyword">DEAllOCATE</span>(<a class="code" href="namespacecontrol__variables.html#af26d46d355bee6c749bf25537333f463">uvec</a>,<a class="code" href="namespacecontrol__variables.html#a3f01352de7c4bb4687c9af3b22110302">uexact</a>,<a class="code" href="namespacecontrol__variables.html#a9f7c2243d548ddee9248892603d7dcdc">resE</a>,<a class="code" href="namespacecontrol__variables.html#a622a60898014b0384693ee589b049bcc">resI</a>)
<a name="l00080"></a>00080       
<a name="l00081"></a>00081       <span class="comment">!data out</span>
<a name="l00082"></a>00082       <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacecontrol__variables.html#a154cb346d1fea6a9ff450290221ee0fe">error</a>,<a class="code" href="namespacecontrol__variables.html#a7522507cf8bc1f3a9330fdfa3afb8df6">errorP</a>,<a class="code" href="namespacecontrol__variables.html#a1a8ae18f1306cb293f5d87041ad835e7">b</a>)
<a name="l00083"></a>00083       
<a name="l00084"></a>00084       <span class="comment">!Newton_iteration</span>
<a name="l00085"></a>00085       <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacecontrol__variables.html#adb75fde9a143a0e98e889020a87a9f4c">usum</a>,<a class="code" href="namespacecontrol__variables.html#afae70ecf2800b85b5556f11ef27e1083">xjac</a>)   
<a name="l00086"></a>00086          
<a name="l00087"></a>00087       <span class="comment">!internal</span>
<a name="l00088"></a>00088       <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacecontrol__variables.html#a70ee148b1d53c7eabd08208a05f0c5bb">ustage</a>,<a class="code" href="namespacecontrol__variables.html#a10062ed742cfed59b3bcc40ba9ba3f1e">predvec</a>,<a class="code" href="namespacecontrol__variables.html#a6fad9568d55bd9d885c4c73fed5c332f">uveco</a>)
<a name="l00089"></a>00089       <span class="keyword">DEALLOCATE</span>(<a class="code" href="namespacecontrol__variables.html#a4715913d9d9a458e7e453251143e30bb">errvec</a>,<a class="code" href="namespacecontrol__variables.html#af335d1c81000a57748875e5f45f335b3">errvecT</a>,<a class="code" href="namespacecontrol__variables.html#a564c7b023cbf232bf7d974084e240135">tmpvec</a>,<a class="code" href="namespacecontrol__variables.html#ae67e7c71c7fbe553dbeab99d7d911445">b1save</a>,<a class="code" href="namespacecontrol__variables.html#adc716da32e194c8cb19ef9b13a8ee8ef">b1Psave</a>)
<a name="l00090"></a>00090       
<a name="l00091"></a>00091       <span class="comment">!CSR</span>
<a name="l00092"></a>00092       <span class="keyword">if</span>(<span class="keyword">allocated</span>(<a class="code" href="namespaceSBP__Coef__Module.html#a1adae037837113781655b270e471ba68">D1</a>)) <span class="keyword">deallocate</span>(<a class="code" href="namespaceSBP__Coef__Module.html#ade29e831cffd3b65ec75561afc42ac69">Pmat</a>,<a class="code" href="namespaceSBP__Coef__Module.html#aae84c8b8ccfc4af6b9622f138494e4d9">Pinv</a>,<a class="code" href="namespaceSBP__Coef__Module.html#a88980715f10265d5c8d1a4ed267a60ab">jD1</a>,<a class="code" href="namespaceSBP__Coef__Module.html#a83634f53cf0308ca3aff67b8f1ba2683">jD2</a>,<a class="code" href="namespaceSBP__Coef__Module.html#a59352f918ff4deadfe38916683618337">iD1</a>,<a class="code" href="namespaceSBP__Coef__Module.html#a925a2e3cb8ac90d224a58b2d5ca2abf4">iD2</a>,<a class="code" href="namespaceSBP__Coef__Module.html#a1adae037837113781655b270e471ba68">D1</a>,<a class="code" href="namespaceSBP__Coef__Module.html#a3f2cc5f7fad0e332d815a65f500fd6ca">D2</a>,<a class="code" href="namespaceSBP__Coef__Module.html#ad13cceaecd47b583a1073a31379c5574">D1_per</a>,&amp;
<a name="l00093"></a>00093      &amp;                              iD1_per,jD1_per) 
<a name="l00094"></a>00094       
<a name="l00095"></a>00095 <span class="keyword">      end subroutine deallocate_vars</span>
<a name="l00096"></a>00096       
<a name="l00097"></a>00097 <span class="comment">!==============================================================================</span>
<a name="l00098"></a>00098       
<a name="l00099"></a>00099 <span class="keyword">      end module control_variables      </span>
</pre></div></div>
<hr size="1"/><address style="text-align: right;"><small>Generated on 25 Jul 2016 for Doxygen Fortran Example by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>

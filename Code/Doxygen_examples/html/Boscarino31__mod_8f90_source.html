<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Doxygen Fortran Example: Boscarino31_mod.f90 Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Modules</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
<h1>Boscarino31_mod.f90</h1><a href="Boscarino31__mod_8f90.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">!*****************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment">! Module containing routines to describe Boscarino&apos;s linear system in &quot;ON A </span>
<a name="l00003"></a>00003 <span class="comment">! CLASS OF UNIFORMLY ACCURATE IMEX RUNGEâ€“KUTTA SCHEMES AND APPLICATIONS TO </span>
<a name="l00004"></a>00004 <span class="comment">! HYPERBOLIC SYSTEMS WITH RELAXATION&quot; pg 11, equations 31a/b. 31a was modified </span>
<a name="l00005"></a>00005 <span class="comment">! to be of the form &quot;u_t+v_x=(b*u+c*v)/epsilon&quot;</span>
<a name="l00006"></a>00006 <span class="comment">!******************************************************************************</span>
<a name="l00007"></a>00007 <span class="comment">! REQUIRED FILES:</span>
<a name="l00008"></a>00008 <span class="comment">! PRECISION_VARS.F90            *DEFINES PRECISION FOR ALL VARIABLES</span>
<a name="l00009"></a>00009 <span class="comment">!******************************************************************************</span>
<a name="l00010"></a>00010 
<a name="l00011"></a><a class="code" href="namespaceBoscarino31__Mod.html">00011</a>       <span class="keyword">module</span> Boscarino31_Mod 
<a name="l00012"></a>00012 
<a name="l00013"></a>00013       use <span class="keywordflow">precision_vars</span>, only: wp,two,pi
<a name="l00014"></a>00014 
<a name="l00015"></a>00015       implicit none; <span class="keywordtype">save</span>
<a name="l00016"></a>00016   
<a name="l00017"></a>00017       <span class="keywordtype">private</span>
<a name="l00018"></a>00018       <span class="keywordtype">public</span>  :: <a class="code" href="namespaceBoscarino31__Mod.html#acb356d5a1e816f2a446f7fe89d5efba5">Boscarino31</a>
<a name="l00019"></a>00019 
<a name="l00020"></a>00020 <span class="comment">!--------------------------------VARIABLES-------------------------------------         </span>
<a name="l00021"></a><a class="code" href="namespaceBoscarino31__Mod.html#ab474ae538abf730dcf9487d0003b2bf6">00021</a>       <span class="keywordtype">integer</span>,  <span class="keywordtype">parameter</span> :: vecl=256 <span class="comment">!must be even  </span>
<a name="l00022"></a><a class="code" href="namespaceBoscarino31__Mod.html#aecfb3cc1244802a5430fbfd79a077ffd">00022</a>       <span class="keywordtype">real(wp)</span>, <span class="keywordtype">parameter</span> :: a=0.5_wp
<a name="l00023"></a><a class="code" href="namespaceBoscarino31__Mod.html#a28bdd090c5b88254bd3570afb9a5cc3d">00023</a>       <span class="keywordtype">real(wp)</span>, <span class="keywordtype">parameter</span> :: xL=-1.0_wp,xR=1.0_wp      
<a name="l00024"></a>00024    
<a name="l00025"></a><a class="code" href="namespaceBoscarino31__Mod.html#ab76ae0e2b218937b93dca10239e3eee6">00025</a>       <span class="keywordtype">real(wp)</span>, <span class="keywordtype">dimension(vecl/2) </span>:: x      
<a name="l00026"></a><a class="code" href="namespaceBoscarino31__Mod.html#a8cd5f962a569f16c3aba794cd1b2e74e">00026</a>       <span class="keywordtype">real(wp)                    </span>:: dx
<a name="l00027"></a>00027 
<a name="l00028"></a><a class="code" href="namespaceBoscarino31__Mod.html#ae80188c9814db4e6c620003c081076d3">00028</a>       <span class="keywordtype">integer</span>,  <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">allocatable</span> :: jDeriv_comb_p
<a name="l00029"></a><a class="code" href="namespaceBoscarino31__Mod.html#a2256a73cd34e2976137854199441abc5">00029</a>       <span class="keywordtype">real(wp)</span>, <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">allocatable</span> :: Deriv_comb_p,wrk_Jac
<a name="l00030"></a><a class="code" href="namespaceBoscarino31__Mod.html#aa3b79880eae513aa43861d6caca177fe">00030</a>       <span class="keywordtype">integer</span>,  <span class="keywordtype">dimension(vecl+1)         </span>:: iSource_p,iDeriv_comb_p
<a name="l00031"></a><a class="code" href="namespaceBoscarino31__Mod.html#a0373748dbe48e52d82b114042fdee990">00031</a>       <span class="keywordtype">integer</span>,  <span class="keywordtype">dimension(:)</span>, <span class="keywordtype">allocatable</span> :: iwrk_Jac,jwrk_Jac
<a name="l00032"></a>00032 
<a name="l00033"></a><a class="code" href="namespaceBoscarino31__Mod.html#afb8a2536db81b82cdd423dcd8a51cded">00033</a>       <span class="keywordtype">real(wp)</span>, <span class="keywordtype">dimension(vecl)           </span>:: Source_p
<a name="l00034"></a><a class="code" href="namespaceBoscarino31__Mod.html#a07cc77f584e047fd4a9c846ed74c348d">00034</a>       <span class="keywordtype">integer</span>,  <span class="keywordtype">dimension(vecl)           </span>:: jSource_p
<a name="l00035"></a><a class="code" href="namespaceBoscarino31__Mod.html#a0f1b24cc3a5d6b758a54d039ef67c1d4">00035</a>       <span class="keywordtype">integer</span> :: nnz_wrk
<a name="l00036"></a><a class="code" href="namespaceBoscarino31__Mod.html#a28171d77556b7fe11ea309e75503be40">00036</a>       <span class="keywordtype">logical</span> :: update_RHS,update_Jac
<a name="l00037"></a>00037 <span class="comment">!------------------------------------------------------------------------------      </span>
<a name="l00038"></a>00038       <span class="keyword">contains</span>    
<a name="l00039"></a>00039 <span class="comment">!==============================================================================</span>
<a name="l00040"></a>00040 <span class="comment">!******************************************************************************</span>
<a name="l00041"></a>00041 <span class="comment">! Subroutine to Initialize, calculate the RHS, and calculate the Jacobian</span>
<a name="l00042"></a>00042 <span class="comment">! of the Burgers problem </span>
<a name="l00043"></a>00043 <span class="comment">!******************************************************************************</span>
<a name="l00044"></a>00044 <span class="comment">! REQUIRED FILES:</span>
<a name="l00045"></a>00045 <span class="comment">! PRECISION_VARS.F90        *DEFINES PRECISION FOR ALL VARIABLES</span>
<a name="l00046"></a>00046 <span class="comment">! CONTROL_VARIABLES.F90     *CONTAINS VARIABLES AND ALLOCATION ROUTINES</span>
<a name="l00047"></a>00047 <span class="comment">!******************************************************************************</span>
<a name="l00048"></a>00048 
<a name="l00049"></a><a class="code" href="namespaceBoscarino31__Mod.html#acb356d5a1e816f2a446f7fe89d5efba5">00049</a>       <span class="keyword">subroutine </span><a class="code" href="namespaceBoscarino31__Mod.html#acb356d5a1e816f2a446f7fe89d5efba5">Boscarino31</a>(nveclen,ep,dt,tfinal,iDT,resE_vec,resI_vec,akk)
<a name="l00050"></a>00050 
<a name="l00051"></a>00051       use <span class="keywordflow">control_variables</span>, only: temporal_splitting,probname,Jac_case, &amp;
<a name="l00052"></a>00052      &amp;                             tol,dt_error_tol,uvec,uexact,programstep
<a name="l00053"></a>00053       use <span class="keywordflow">SBP_Coef_Module</span>,   only: Define_CSR_Operators,D1_per
<a name="l00054"></a>00054       use <span class="keywordflow">unary_mod</span>,         only: aplb
<a name="l00055"></a>00055       use <span class="keywordflow">Jacobian_CSR_Mod</span>,  only: Allocate_Jac_CSR_Storage<span class="comment">!,  iaJac, jaJac,  aJac</span>
<a name="l00056"></a>00056 
<a name="l00057"></a>00057 <span class="comment">!-----------------------VARIABLES----------------------------------------------</span>
<a name="l00058"></a>00058       <span class="comment">!INIT vars     </span>
<a name="l00059"></a>00059       <span class="keywordtype">real(wp)</span>, <span class="keywordtype">intent(in   )</span> :: ep
<a name="l00060"></a>00060       <span class="keywordtype">real(wp)</span>, <span class="keywordtype">intent(inout)</span> :: dt
<a name="l00061"></a>00061       <span class="keywordtype">integer</span>,  <span class="keywordtype">intent(  out)</span> :: nveclen
<a name="l00062"></a>00062       <span class="keywordtype">real(wp)</span>, <span class="keywordtype">intent(  out)</span> :: tfinal
<a name="l00063"></a>00063       <span class="keywordtype">integer</span>,  <span class="keywordtype">intent(in   )</span> :: iDT
<a name="l00064"></a>00064       
<a name="l00065"></a>00065       <span class="comment">!RHS vars</span>
<a name="l00066"></a>00066       <span class="keywordtype">real(wp)</span>, <span class="keywordtype">dimension(vecl)</span>, <span class="keywordtype">intent(  out)</span> :: resE_vec,resI_vec
<a name="l00067"></a>00067       <span class="keywordtype">real(wp)</span>, <span class="keywordtype">dimension(vecl)                </span>:: dudt_D1,dudt_Source
<a name="l00068"></a>00068       
<a name="l00069"></a>00069       <span class="comment">!Jacob vars</span>
<a name="l00070"></a>00070       <span class="keywordtype">real(wp)</span>, <span class="keywordtype">intent(in   )</span>  :: akk
<a name="l00071"></a>00071       <span class="keywordtype">integer</span>                  :: nnz_Jac,ierr=0
<a name="l00072"></a>00072       <span class="keywordtype">integer</span>, <span class="keywordtype">dimension(vecl) </span>:: iw
<a name="l00073"></a>00073 <span class="comment">!------------------------------------------------------------------------------   </span>
<a name="l00074"></a>00074       
<a name="l00075"></a>00075       Program_Step_Select: <span class="keyword">select</span> <span class="keyword">case</span>(programstep)
<a name="l00076"></a>00076         <span class="comment">!**Pre-initialization. Get problem name, vector length and grid**</span>
<a name="l00077"></a>00077         <span class="keyword">case</span>(<span class="stringliteral">&apos;INITIALIZE_PROBLEM_INFORMATION&apos;</span>)
<a name="l00078"></a>00078           nveclen = <a class="code" href="namespaceBoscarino31__Mod.html#ab474ae538abf730dcf9487d0003b2bf6">vecl</a>
<a name="l00079"></a>00079           <a class="code" href="namespacecontrol__variables.html#ab4dc4a4fa46d7037bf7d9aaa1ab3e81c">probname</a>=<span class="stringliteral">&apos;Boscar_31&apos;</span>     
<a name="l00080"></a>00080           <a class="code" href="namespacecontrol__variables.html#a291e2e72b0a3f05b05ea09624acb6878">Jac_case</a>=<span class="stringliteral">&apos;SPARSE&apos;</span>
<a name="l00081"></a>00081           tol=1.0e-12_wp  
<a name="l00082"></a>00082           dt_error_tol=5.0e-14_wp
<a name="l00083"></a>00083           call <a class="code" href="namespaceBoscarino31__Mod.html#a00b0167e7c4d1733088267871a56beb2">grid</a>()           
<a name="l00084"></a>00084 
<a name="l00085"></a>00085         <span class="comment">!**Initialization of problem information**        </span>
<a name="l00086"></a>00086         <span class="keyword">case</span>(<span class="stringliteral">&apos;SET_INITIAL_CONDITIONS&apos;</span>)
<a name="l00087"></a>00087           
<a name="l00088"></a>00088           <span class="comment">!Update=true for Jac/RHS updates</span>
<a name="l00089"></a>00089           <a class="code" href="namespaceBoscarino31__Mod.html#a28171d77556b7fe11ea309e75503be40">update_RHS</a>=.true.; <a class="code" href="namespaceBoscarino31__Mod.html#a7fba92dc16246a92b90cde6cef417ca9">update_Jac</a>=.true. <span class="comment">!reset every new epsilon/dt</span>
<a name="l00090"></a>00090           
<a name="l00091"></a>00091           <span class="comment">!Allocate derivative operators</span>
<a name="l00092"></a>00092           <span class="keyword">if</span>(.not. <span class="keyword">allocated</span>(<a class="code" href="namespaceSBP__Coef__Module.html#ad13cceaecd47b583a1073a31379c5574">D1_per</a>)) <span class="keyword">then</span>
<a name="l00093"></a>00093             call <a class="code" href="namespaceSBP__Coef__Module.html#a2a470b5ce579d35823d5a3b0cdfc0d25">Define_CSR_Operators</a>(<a class="code" href="namespaceBoscarino31__Mod.html#ab474ae538abf730dcf9487d0003b2bf6">vecl</a>/2,<a class="code" href="namespaceBoscarino31__Mod.html#a8cd5f962a569f16c3aba794cd1b2e74e">dx</a>)   
<a name="l00094"></a>00094             <span class="comment">!needed for implicit jacobian</span>
<a name="l00095"></a>00095             <a class="code" href="namespaceBoscarino31__Mod.html#a0f1b24cc3a5d6b758a54d039ef67c1d4">nnz_wrk</a>=2*<span class="keyword">size</span>(<a class="code" href="namespaceSBP__Coef__Module.html#ad13cceaecd47b583a1073a31379c5574">D1_per</a>)+<a class="code" href="namespaceBoscarino31__Mod.html#ab474ae538abf730dcf9487d0003b2bf6">vecl</a>
<a name="l00096"></a>00096             <span class="keyword">allocate</span>(<a class="code" href="namespaceBoscarino31__Mod.html#a2256a73cd34e2976137854199441abc5">wrk_Jac</a>(<a class="code" href="namespaceBoscarino31__Mod.html#a0f1b24cc3a5d6b758a54d039ef67c1d4">nnz_wrk</a>))
<a name="l00097"></a>00097             <span class="keyword">allocate</span>(<a class="code" href="namespaceBoscarino31__Mod.html#a150544c22a5c54fcdb4efedd509cb511">iwrk_Jac</a>(<a class="code" href="namespaceBoscarino31__Mod.html#ab474ae538abf730dcf9487d0003b2bf6">vecl</a>+1))
<a name="l00098"></a>00098             <span class="keyword">allocate</span>(<a class="code" href="namespaceBoscarino31__Mod.html#a0373748dbe48e52d82b114042fdee990">jwrk_Jac</a>(<a class="code" href="namespaceBoscarino31__Mod.html#a0f1b24cc3a5d6b758a54d039ef67c1d4">nnz_wrk</a>))          
<a name="l00099"></a>00099           <span class="keyword">endif</span>
<a name="l00100"></a>00100           
<a name="l00101"></a>00101           <span class="comment">!Time information</span>
<a name="l00102"></a>00102           tfinal = 0.2_wp  <span class="comment">! final time   </span>
<a name="l00103"></a>00103           choose_dt: <span class="keyword">select</span> <span class="keyword">case</span>(temporal_splitting)
<a name="l00104"></a>00104             <span class="keyword">case</span>(<span class="stringliteral">&apos;EXPLICIT&apos;</span>); dt = 0.000025_wp*0.1_wp/10**((iDT-1)/20.0_wp) <span class="comment">! explicit timestep</span>
<a name="l00105"></a>00105             <span class="keyword">case</span> default    ; dt = 0.2_wp/10**((iDT-1)/20.0_wp)             <span class="comment">! implicit timestep      </span>
<a name="l00106"></a>00106           <span class="keyword">end select</span> choose_dt
<a name="l00107"></a>00107           
<a name="l00108"></a>00108           <span class="comment">! Set IC&apos;s</span>
<a name="l00109"></a>00109           uvec(1:<a class="code" href="namespaceBoscarino31__Mod.html#ab474ae538abf730dcf9487d0003b2bf6">vecl</a>:2)=sin(<a class="code" href="namespaceprecision__vars.html#aa062b339d028cb99bfdf249224f77661">two</a>*<a class="code" href="namespaceprecision__vars.html#a5d3c9e506d81adeae20c38194ab26030">pi</a>*<a class="code" href="namespaceBoscarino31__Mod.html#ab76ae0e2b218937b93dca10239e3eee6">x</a>(:))
<a name="l00110"></a>00110           uvec(2:<a class="code" href="namespaceBoscarino31__Mod.html#ab474ae538abf730dcf9487d0003b2bf6">vecl</a>:2)=<a class="code" href="namespaceBoscarino31__Mod.html#aecfb3cc1244802a5430fbfd79a077ffd">a</a>*sin(<a class="code" href="namespaceprecision__vars.html#aa062b339d028cb99bfdf249224f77661">two</a>*<a class="code" href="namespaceprecision__vars.html#a5d3c9e506d81adeae20c38194ab26030">pi</a>*<a class="code" href="namespaceBoscarino31__Mod.html#ab76ae0e2b218937b93dca10239e3eee6">x</a>(:))+ep*(<a class="code" href="namespaceBoscarino31__Mod.html#aecfb3cc1244802a5430fbfd79a077ffd">a</a>**2-1)*<a class="code" href="namespaceprecision__vars.html#aa062b339d028cb99bfdf249224f77661">two</a>*<a class="code" href="namespaceprecision__vars.html#a5d3c9e506d81adeae20c38194ab26030">pi</a>*cos(<a class="code" href="namespaceprecision__vars.html#aa062b339d028cb99bfdf249224f77661">two</a>*<a class="code" href="namespaceprecision__vars.html#a5d3c9e506d81adeae20c38194ab26030">pi</a>*<a class="code" href="namespaceBoscarino31__Mod.html#ab76ae0e2b218937b93dca10239e3eee6">x</a>(:))
<a name="l00111"></a>00111          
<a name="l00112"></a>00112           <span class="comment">!set exact solution at tfinal</span>
<a name="l00113"></a>00113           call <a class="code" href="namespaceBoscarino31__Mod.html#ae2c861acb2247bbd816cbb93696a8914">exact_Bosc</a>(uexact,ep) 
<a name="l00114"></a>00114               
<a name="l00115"></a>00115         <span class="keyword">case</span>(<span class="stringliteral">&apos;BUILD_RHS&apos;</span>)
<a name="l00116"></a>00116           choose_RHS_type: <span class="keyword">select</span> <span class="keyword">case</span> (Temporal_Splitting)       
<a name="l00117"></a>00117             <span class="keyword">case</span>(<span class="stringliteral">&apos;EXPLICIT&apos;</span>)
<a name="l00118"></a>00118               call <a class="code" href="namespaceBoscarino31__Mod.html#aba6ef998cf5ea9e4113dbccb62bb9fc3">Bosc_dUdt</a>(uvec,dudt_D1,dudt_Source,ep)
<a name="l00119"></a>00119               resE_vec(:)=dt*(dudt_D1(:)+dudt_Source(:))
<a name="l00120"></a>00120               resI_vec(:)=0.0_wp                   
<a name="l00121"></a>00121             <span class="keyword">case</span>(<span class="stringliteral">&apos;IMPLICIT&apos;</span>)
<a name="l00122"></a>00122               call <a class="code" href="namespaceBoscarino31__Mod.html#aba6ef998cf5ea9e4113dbccb62bb9fc3">Bosc_dUdt</a>(uvec,dudt_D1,dudt_Source,ep)
<a name="l00123"></a>00123               resE_vec(:)=0.0_wp
<a name="l00124"></a>00124               resI_vec(:)=dt*(dudt_D1(:)+dudt_Source(:))
<a name="l00125"></a>00125             <span class="keyword">case</span>(<span class="stringliteral">&apos;IMEX&apos;</span>)
<a name="l00126"></a>00126               call <a class="code" href="namespaceBoscarino31__Mod.html#aba6ef998cf5ea9e4113dbccb62bb9fc3">Bosc_dUdt</a>(uvec,dudt_D1,dudt_Source,ep)
<a name="l00127"></a>00127               resE_vec(:)=dt*dudt_D1(:)
<a name="l00128"></a>00128               resI_vec(:)=dt*dudt_Source(:)
<a name="l00129"></a>00129           <span class="keyword">end select</span> choose_RHS_type
<a name="l00130"></a>00130           <a class="code" href="namespaceBoscarino31__Mod.html#a28171d77556b7fe11ea309e75503be40">update_RHS</a>=.false. <span class="comment">!no need to update RHS until next epsilon</span>
<a name="l00131"></a>00131           
<a name="l00132"></a>00132         <span class="keyword">case</span>(<span class="stringliteral">&apos;BUILD_JACOBIAN&apos;</span>)
<a name="l00133"></a>00133           choose_Jac_type: <span class="keyword">select</span> <span class="keyword">case</span>(temporal_splitting)
<a name="l00134"></a>00134             <span class="keyword">case</span>(<span class="stringliteral">&apos;IMPLICIT&apos;</span>)
<a name="l00135"></a>00135               <span class="keyword">if</span> (<a class="code" href="namespaceBoscarino31__Mod.html#a7fba92dc16246a92b90cde6cef417ca9">update_Jac</a>) <span class="keyword">then</span>
<a name="l00136"></a>00136                 nnz_Jac=<a class="code" href="namespaceBoscarino31__Mod.html#a0f1b24cc3a5d6b758a54d039ef67c1d4">nnz_wrk</a>+<a class="code" href="namespaceBoscarino31__Mod.html#ab474ae538abf730dcf9487d0003b2bf6">vecl</a>/2
<a name="l00137"></a>00137                 call <a class="code" href="namespaceJacobian__CSR__Mod.html#ab251b185ad5d74ee771ea99d2a7f3935">Allocate_Jac_CSR_Storage</a>(<a class="code" href="namespaceBoscarino31__Mod.html#ab474ae538abf730dcf9487d0003b2bf6">vecl</a>,nnz_Jac)
<a name="l00138"></a>00138              
<a name="l00139"></a>00139                 call <a class="code" href="namespaceunary__mod.html#ad0d8a19e91684be702bb07ef7fe3a59c">aplb</a>(<a class="code" href="namespaceBoscarino31__Mod.html#ab474ae538abf730dcf9487d0003b2bf6">vecl</a>,<a class="code" href="namespaceBoscarino31__Mod.html#ab474ae538abf730dcf9487d0003b2bf6">vecl</a>,1,<a class="code" href="namespaceBoscarino31__Mod.html#afb8a2536db81b82cdd423dcd8a51cded">Source_p</a>,<a class="code" href="namespaceBoscarino31__Mod.html#a07cc77f584e047fd4a9c846ed74c348d">jSource_p</a>,<a class="code" href="namespaceBoscarino31__Mod.html#aa3b79880eae513aa43861d6caca177fe">iSource_p</a>,    &amp;
<a name="l00140"></a>00140      &amp;                    <a class="code" href="namespaceBoscarino31__Mod.html#a711c0293fded4a1a022d6cae8cc33c2c">Deriv_comb_p</a>,<a class="code" href="namespaceBoscarino31__Mod.html#ae80188c9814db4e6c620003c081076d3">jDeriv_comb_p</a>,<a class="code" href="namespaceBoscarino31__Mod.html#a4b597dec754853fe99f9ef0c23894dc6">iDeriv_comb_p</a>, &amp;
<a name="l00141"></a>00141      &amp;                    <a class="code" href="namespaceBoscarino31__Mod.html#a2256a73cd34e2976137854199441abc5">wrk_Jac</a>,<a class="code" href="namespaceBoscarino31__Mod.html#a0373748dbe48e52d82b114042fdee990">jwrk_Jac</a>,<a class="code" href="namespaceBoscarino31__Mod.html#a150544c22a5c54fcdb4efedd509cb511">iwrk_Jac</a>,<a class="code" href="namespaceBoscarino31__Mod.html#a0f1b24cc3a5d6b758a54d039ef67c1d4">nnz_wrk</a>,iw,ierr) 
<a name="l00142"></a>00142                 <span class="keyword">if</span> (ierr/=0) then; print*,<span class="stringliteral">&apos;Build Jac ierr=&apos;</span>,ierr; stop; <span class="keyword">endif</span> 
<a name="l00143"></a>00143               <span class="keyword">endif</span>
<a name="l00144"></a>00144               call <a class="code" href="namespaceBoscarino31__Mod.html#a879eecc4a61be972f3b34b7f121a57f0">Bosc_Jac</a>(dt,akk,<a class="code" href="namespaceBoscarino31__Mod.html#a2256a73cd34e2976137854199441abc5">wrk_Jac</a>,<a class="code" href="namespaceBoscarino31__Mod.html#a0373748dbe48e52d82b114042fdee990">jwrk_Jac</a>,<a class="code" href="namespaceBoscarino31__Mod.html#a150544c22a5c54fcdb4efedd509cb511">iwrk_Jac</a>)       
<a name="l00145"></a>00145                         
<a name="l00146"></a>00146             <span class="keyword">case</span>(<span class="stringliteral">&apos;IMEX&apos;</span>)
<a name="l00147"></a>00147               nnz_Jac=<a class="code" href="namespaceBoscarino31__Mod.html#ab474ae538abf730dcf9487d0003b2bf6">vecl</a>+<a class="code" href="namespaceBoscarino31__Mod.html#ab474ae538abf730dcf9487d0003b2bf6">vecl</a>/2
<a name="l00148"></a>00148               call <a class="code" href="namespaceJacobian__CSR__Mod.html#ab251b185ad5d74ee771ea99d2a7f3935">Allocate_Jac_CSR_Storage</a>(<a class="code" href="namespaceBoscarino31__Mod.html#ab474ae538abf730dcf9487d0003b2bf6">vecl</a>,nnz_Jac)
<a name="l00149"></a>00149               call <a class="code" href="namespaceBoscarino31__Mod.html#a879eecc4a61be972f3b34b7f121a57f0">Bosc_Jac</a>(dt,akk,<a class="code" href="namespaceBoscarino31__Mod.html#afb8a2536db81b82cdd423dcd8a51cded">Source_p</a>,<a class="code" href="namespaceBoscarino31__Mod.html#a07cc77f584e047fd4a9c846ed74c348d">jSource_p</a>,<a class="code" href="namespaceBoscarino31__Mod.html#aa3b79880eae513aa43861d6caca177fe">iSource_p</a>)
<a name="l00150"></a>00150               
<a name="l00151"></a>00151           <span class="keyword">end select</span> choose_Jac_type
<a name="l00152"></a>00152           <a class="code" href="namespaceBoscarino31__Mod.html#a7fba92dc16246a92b90cde6cef417ca9">update_Jac</a>=.false.  <span class="comment">!no need to update matrix that forms Jacobian until next epsilon/dt</span>
<a name="l00153"></a>00153           
<a name="l00154"></a>00154       <span class="keyword">end select</span> Program_Step_Select     
<a name="l00155"></a>00155 <span class="keyword">      end subroutine Boscarino31</span>
<a name="l00156"></a>00156 <span class="comment">!==============================================================================</span>
<a name="l00157"></a>00157 <span class="comment">!==============================================================================</span>
<a name="l00158"></a>00158 <span class="comment">!==============================================================================</span>
<a name="l00159"></a>00159 <span class="comment">! PRODUCES GRID</span>
<a name="l00160"></a><a class="code" href="namespaceBoscarino31__Mod.html#a00b0167e7c4d1733088267871a56beb2">00160</a>       <span class="keyword">subroutine </span><a class="code" href="namespaceBoscarino31__Mod.html#a00b0167e7c4d1733088267871a56beb2">grid</a>()
<a name="l00161"></a>00161       <span class="keywordtype">integer</span> :: i
<a name="l00162"></a>00162       
<a name="l00163"></a>00163       <span class="keyword">do</span> i=1,<a class="code" href="namespaceBoscarino31__Mod.html#ab474ae538abf730dcf9487d0003b2bf6">vecl</a>/2
<a name="l00164"></a>00164         <a class="code" href="namespaceBoscarino31__Mod.html#ab76ae0e2b218937b93dca10239e3eee6">x</a>(i)= <a class="code" href="namespaceBoscarino31__Mod.html#a5ef7d427a6cdb8b601b4416fc823ee68">xL</a> + (<a class="code" href="namespaceBoscarino31__Mod.html#a28bdd090c5b88254bd3570afb9a5cc3d">xR</a>-<a class="code" href="namespaceBoscarino31__Mod.html#a5ef7d427a6cdb8b601b4416fc823ee68">xL</a>)*(i-1.0_wp)/(<a class="code" href="namespaceBoscarino31__Mod.html#ab474ae538abf730dcf9487d0003b2bf6">vecl</a>/2)
<a name="l00165"></a>00165       <span class="keyword">enddo</span>
<a name="l00166"></a>00166       
<a name="l00167"></a>00167       <a class="code" href="namespaceBoscarino31__Mod.html#a8cd5f962a569f16c3aba794cd1b2e74e">dx</a>=<a class="code" href="namespaceBoscarino31__Mod.html#ab76ae0e2b218937b93dca10239e3eee6">x</a>(2)-<a class="code" href="namespaceBoscarino31__Mod.html#ab76ae0e2b218937b93dca10239e3eee6">x</a>(1)
<a name="l00168"></a>00168 
<a name="l00169"></a>00169 <span class="keyword">      end subroutine grid</span>
<a name="l00170"></a>00170 <span class="comment">!==============================================================================</span>
<a name="l00171"></a>00171 <span class="comment">! RETURNS VECTOR WITH EXACT SOLUTION</span>
<a name="l00172"></a><a class="code" href="namespaceBoscarino31__Mod.html#ae2c861acb2247bbd816cbb93696a8914">00172</a>       <span class="keyword">subroutine </span><a class="code" href="namespaceBoscarino31__Mod.html#ae2c861acb2247bbd816cbb93696a8914">exact_Bosc</a>(u,eps)
<a name="l00173"></a>00173 
<a name="l00174"></a>00174       <span class="keywordtype">real(wp)</span>,                  <span class="keywordtype">intent(in   )</span> :: eps
<a name="l00175"></a>00175       <span class="keywordtype">real(wp)</span>, <span class="keywordtype">dimension(vecl)</span>, <span class="keywordtype">intent(  out)</span> :: u
<a name="l00176"></a>00176 
<a name="l00177"></a>00177       <span class="keywordtype">integer</span>                                  :: i
<a name="l00178"></a>00178       <span class="keywordtype">real(wp)</span>, <span class="keywordtype">dimension(81,vecl+1) </span>:: ExactTot
<a name="l00179"></a>00179       <span class="keywordtype">real(wp) </span>:: diff
<a name="l00180"></a>00180 
<a name="l00181"></a>00181       u(:)=0.0_wp
<a name="l00182"></a>00182       
<a name="l00183"></a>00183       <span class="comment">!**Exact Solution** </span>
<a name="l00184"></a>00184       <span class="keyword">open</span>(unit=39,file=<span class="stringliteral">&apos;exact.Bosc_31_512.data&apos;</span>)
<a name="l00185"></a>00185       rewind(39)
<a name="l00186"></a>00186       <span class="keyword">do</span> i=1,81
<a name="l00187"></a>00187         <span class="keyword">read</span>(39,*)ExactTot(i,1:<a class="code" href="namespaceBoscarino31__Mod.html#ab474ae538abf730dcf9487d0003b2bf6">vecl</a>)
<a name="l00188"></a>00188         ExactTot(i,<a class="code" href="namespaceBoscarino31__Mod.html#ab474ae538abf730dcf9487d0003b2bf6">vecl</a>+1) = 1.0_wp/10**((i-1)/(10.0_wp))  <span class="comment">!  used for 81 values of ep</span>
<a name="l00189"></a>00189       <span class="keyword">enddo</span>
<a name="l00190"></a>00190       <span class="keyword">do</span> i=1,81
<a name="l00191"></a>00191         diff = abs(ExactTot(i,<a class="code" href="namespaceBoscarino31__Mod.html#ab474ae538abf730dcf9487d0003b2bf6">vecl</a>+1) - eps)
<a name="l00192"></a>00192         <span class="keyword">if</span>(diff &lt;= 1.0e-10_wp)<span class="keyword">then</span>
<a name="l00193"></a>00193           u(:) = ExactTot(i,:<a class="code" href="namespaceBoscarino31__Mod.html#ab474ae538abf730dcf9487d0003b2bf6">vecl</a>)
<a name="l00194"></a>00194           exit
<a name="l00195"></a>00195         <span class="keyword">endif</span>
<a name="l00196"></a>00196       <span class="keyword">enddo</span>
<a name="l00197"></a>00197 
<a name="l00198"></a>00198 <span class="keyword">      end subroutine exact_Bosc</span>
<a name="l00199"></a>00199 
<a name="l00200"></a>00200 <span class="comment">!==============================================================================</span>
<a name="l00201"></a>00201 <span class="comment">! DEFINES RHS </span>
<a name="l00202"></a><a class="code" href="namespaceBoscarino31__Mod.html#aba6ef998cf5ea9e4113dbccb62bb9fc3">00202</a>       <span class="keyword">subroutine </span><a class="code" href="namespaceBoscarino31__Mod.html#aba6ef998cf5ea9e4113dbccb62bb9fc3">Bosc_dUdt</a>(u,dudt_D1,dudt_source,eps)
<a name="l00203"></a>00203       
<a name="l00204"></a>00204       use <span class="keywordflow">SBP_Coef_Module</span>, only: D1_per,jD1_per,iD1_per
<a name="l00205"></a>00205       use <span class="keywordflow">matvec_module</span>,   only: amux
<a name="l00206"></a>00206       use <span class="keywordflow">unary_mod</span>,       only: aplb, dperm, csort
<a name="l00207"></a>00207 
<a name="l00208"></a>00208       <span class="keywordtype">real(wp)</span>, <span class="keywordtype">dimension(vecl)</span>, <span class="keywordtype">intent(in   )</span> :: u
<a name="l00209"></a>00209       <span class="keywordtype">real(wp)</span>, <span class="keywordtype">dimension(vecl)</span>, <span class="keywordtype">intent(  out)</span> :: dudt_D1,dudt_source
<a name="l00210"></a>00210       <span class="keywordtype">real(wp)</span>,                  <span class="keywordtype">intent(in   )</span> :: eps
<a name="l00211"></a>00211            
<a name="l00212"></a>00212       <span class="keywordtype">real(wp)</span>, <span class="keywordtype">dimension(vecl/2)                </span>:: LR_Source,LL_Source
<a name="l00213"></a>00213       <span class="keywordtype">integer</span>,  <span class="keywordtype">dimension(vecl/2)                </span>:: jLR_Source,jLL_Source
<a name="l00214"></a>00214       
<a name="l00215"></a>00215       <span class="keywordtype">real(wp)</span>, dimension(size( D1_per))         :: UR_D1,LL_D1
<a name="l00216"></a>00216       <span class="keywordtype">integer</span>,  dimension(size(jD1_per))         :: UR_jD1,LL_jD1
<a name="l00217"></a>00217        
<a name="l00218"></a>00218       <span class="keywordtype">real(wp)</span>, <span class="keywordtype">dimension(vecl)                  </span>:: Source
<a name="l00219"></a>00219       <span class="keywordtype">integer</span>,  <span class="keywordtype">dimension(vecl)                  </span>:: jSource,j_perm
<a name="l00220"></a>00220         
<a name="l00221"></a>00221       <span class="keywordtype">real(wp)</span>, dimension(2*size( D1_per))       :: Deriv_comb
<a name="l00222"></a>00222       <span class="keywordtype">integer</span>,  dimension(2*size( D1_per))       :: jDeriv_comb
<a name="l00223"></a>00223             
<a name="l00224"></a>00224       <span class="keywordtype">integer</span>,  dimension(2*size(D1_per)+vecl)   :: iw
<a name="l00225"></a>00225       
<a name="l00226"></a>00226       <span class="keywordtype">integer</span>,  <span class="keywordtype">dimension(vecl+1)                </span>:: iLR_Source,iLL_Source
<a name="l00227"></a>00227       <span class="keywordtype">integer</span>,  <span class="keywordtype">dimension(vecl+1)                </span>:: UR_iD1,LL_iD1,iSource
<a name="l00228"></a>00228       <span class="keywordtype">integer</span>,  <span class="keywordtype">dimension(vecl+1)                </span>:: iDeriv_comb
<a name="l00229"></a>00229            
<a name="l00230"></a>00230       <span class="keywordtype">integer</span>,  dimension(4*size(D1_per)+2*vecl) :: iwork           
<a name="l00231"></a>00231            
<a name="l00232"></a>00232       <span class="keywordtype">integer</span>,<span class="keywordtype">dimension(3) </span>:: ierr
<a name="l00233"></a>00233       <span class="keywordtype">integer</span>              :: i
<a name="l00234"></a>00234 
<a name="l00235"></a>00235 <span class="comment">!------------------------------------------------------------------------------</span>
<a name="l00236"></a>00236       <span class="keyword">if</span> (.not. <span class="keyword">allocated</span>(<a class="code" href="namespaceBoscarino31__Mod.html#a711c0293fded4a1a022d6cae8cc33c2c">Deriv_comb_p</a>)) <span class="keyword">then</span>
<a name="l00237"></a>00237         <span class="keyword">allocate</span>(<a class="code" href="namespaceBoscarino31__Mod.html#a711c0293fded4a1a022d6cae8cc33c2c">Deriv_comb_p</a>(2*<span class="keyword">size</span>(D1_per)),<a class="code" href="namespaceBoscarino31__Mod.html#ae80188c9814db4e6c620003c081076d3">jDeriv_comb_p</a>(2*<span class="keyword">size</span>(D1_per)))
<a name="l00238"></a>00238       <span class="keyword">endif</span>
<a name="l00239"></a>00239       
<a name="l00240"></a>00240       <span class="keyword">if</span> (<a class="code" href="namespaceBoscarino31__Mod.html#a28171d77556b7fe11ea309e75503be40">update_RHS</a>) <span class="keyword">then</span>
<a name="l00241"></a>00241         
<a name="l00242"></a>00242 <span class="comment">! Set lower right diageaonal</span>
<a name="l00243"></a>00243 <span class="comment">! | | |</span>
<a name="l00244"></a>00244 <span class="comment">! | |x|</span>
<a name="l00245"></a>00245         LR_Source(:)=-1.0_wp/eps
<a name="l00246"></a>00246         iLR_Source(:vecl/2)   = 1
<a name="l00247"></a>00247         iLR_Source(vecl/2+1:) = (/ (i, i=1, vecl/2+1) /)
<a name="l00248"></a>00248         jLR_Source(:)=(/ (i, i=vecl/2+1, vecl) /)
<a name="l00249"></a>00249 
<a name="l00250"></a>00250 <span class="comment">! Set lower left diagonal</span>
<a name="l00251"></a>00251 <span class="comment">! | | |</span>
<a name="l00252"></a>00252 <span class="comment">! |x| |</span>
<a name="l00253"></a>00253         LL_Source(:)=<a class="code" href="namespaceBoscarino31__Mod.html#aecfb3cc1244802a5430fbfd79a077ffd">a</a>/eps
<a name="l00254"></a>00254         iLL_Source(:vecl/2)   = 1
<a name="l00255"></a>00255         iLL_Source(vecl/2+1:) = (/ (i, i=1, vecl/2+1) /)
<a name="l00256"></a>00256         jLL_Source(:)=(/ (i, i=1, vecl/2) /)      
<a name="l00257"></a>00257       
<a name="l00258"></a>00258 <span class="comment">! Set upper right D1</span>
<a name="l00259"></a>00259 <span class="comment">! | |x|</span>
<a name="l00260"></a>00260 <span class="comment">! | | |      </span>
<a name="l00261"></a>00261         UR_D1=(-1.0_wp)*D1_per
<a name="l00262"></a>00262         UR_iD1(:vecl/2+1)=<a class="code" href="namespaceSBP__Coef__Module.html#aee75987a58a3553015d1a40c74a484d8">iD1_per</a>
<a name="l00263"></a>00263         UR_iD1(vecl/2+2:)=<a class="code" href="namespaceSBP__Coef__Module.html#aee75987a58a3553015d1a40c74a484d8">iD1_per</a>(vecl/2+1)
<a name="l00264"></a>00264         UR_jD1=jD1_per(:)+vecl/2
<a name="l00265"></a>00265       
<a name="l00266"></a>00266 <span class="comment">! Set lower left D1</span>
<a name="l00267"></a>00267 <span class="comment">! | | |</span>
<a name="l00268"></a>00268 <span class="comment">! |x| |      </span>
<a name="l00269"></a>00269         LL_D1=(-1.0_wp)*D1_per
<a name="l00270"></a>00270         LL_iD1(:vecl/2)=1
<a name="l00271"></a>00271         LL_iD1(vecl/2+1:)=<a class="code" href="namespaceSBP__Coef__Module.html#aee75987a58a3553015d1a40c74a484d8">iD1_per</a>
<a name="l00272"></a>00272         LL_jD1=jD1_per
<a name="l00273"></a>00273 
<a name="l00274"></a>00274 <span class="comment">! Add all matricies</span>
<a name="l00275"></a>00275       <span class="comment">! combine both diagonals</span>
<a name="l00276"></a>00276       <span class="comment">! | | |</span>
<a name="l00277"></a>00277       <span class="comment">! |x|x|</span>
<a name="l00278"></a>00278         call <a class="code" href="namespaceunary__mod.html#ad0d8a19e91684be702bb07ef7fe3a59c">aplb</a>(vecl,vecl,1,LL_Source,jLL_Source,iLL_Source,LR_Source, &amp;
<a name="l00279"></a>00279      &amp;            jLR_Source,iLR_Source,Source,jSource,iSource,vecl,iw,ierr(1))
<a name="l00280"></a>00280       
<a name="l00281"></a>00281       <span class="comment">! combine both D1&apos;s</span>
<a name="l00282"></a>00282       <span class="comment">! | |x|</span>
<a name="l00283"></a>00283       <span class="comment">! |x| |</span>
<a name="l00284"></a>00284         call <a class="code" href="namespaceunary__mod.html#ad0d8a19e91684be702bb07ef7fe3a59c">aplb</a>(vecl,vecl,1,LL_D1,LL_jD1,LL_iD1,UR_D1,UR_jD1,UR_iD1,    &amp;
<a name="l00285"></a>00285      &amp;            Deriv_comb,jDeriv_comb,iDeriv_comb,2*<span class="keyword">size</span>(D1_per),iw,ierr(2))   
<a name="l00286"></a>00286           
<a name="l00287"></a>00287 <span class="comment">! permute matrix into:</span>
<a name="l00288"></a>00288 <span class="comment">! |x| |</span>
<a name="l00289"></a>00289 <span class="comment">! | |x|</span>
<a name="l00290"></a>00290         j_perm(1)=1
<a name="l00291"></a>00291         j_perm(vecl/2+1)=2
<a name="l00292"></a>00292         <span class="keyword">do</span> i=2,vecl
<a name="l00293"></a>00293           <span class="keyword">if</span> (i==vecl/2+1) cycle
<a name="l00294"></a>00294           j_perm(i)=j_perm(i-1) + 2
<a name="l00295"></a>00295         <span class="keyword">enddo</span>
<a name="l00296"></a>00296         
<a name="l00297"></a>00297       <span class="comment">! permute source&apos;s matrix    </span>
<a name="l00298"></a>00298         call <a class="code" href="namespaceunary__mod.html#a8247fa4ab43954b9f840fc56fd441c23">dperm</a>(vecl,Source,jSource,iSource,<a class="code" href="namespaceBoscarino31__Mod.html#afb8a2536db81b82cdd423dcd8a51cded">Source_p</a>,<a class="code" href="namespaceBoscarino31__Mod.html#a07cc77f584e047fd4a9c846ed74c348d">jSource_p</a>,<a class="code" href="namespaceBoscarino31__Mod.html#aa3b79880eae513aa43861d6caca177fe">iSource_p</a>, &amp;
<a name="l00299"></a>00299      &amp;             j_perm,j_perm,1)
<a name="l00300"></a>00300         call <a class="code" href="namespaceunary__mod.html#ad981e96208abed6b51f14cda0410b0f5">csort</a>(vecl,<a class="code" href="namespaceBoscarino31__Mod.html#afb8a2536db81b82cdd423dcd8a51cded">Source_p</a>,<a class="code" href="namespaceBoscarino31__Mod.html#a07cc77f584e047fd4a9c846ed74c348d">jSource_p</a>,<a class="code" href="namespaceBoscarino31__Mod.html#aa3b79880eae513aa43861d6caca177fe">iSource_p</a>,iwork,.true.)  
<a name="l00301"></a>00301    
<a name="l00302"></a>00302       <span class="comment">! permute D1&apos;s matrix   </span>
<a name="l00303"></a>00303         call <a class="code" href="namespaceunary__mod.html#a8247fa4ab43954b9f840fc56fd441c23">dperm</a>(vecl,Deriv_comb,jDeriv_comb,iDeriv_comb,<a class="code" href="namespaceBoscarino31__Mod.html#a711c0293fded4a1a022d6cae8cc33c2c">Deriv_comb_p</a>,      &amp;
<a name="l00304"></a>00304      &amp;             <a class="code" href="namespaceBoscarino31__Mod.html#ae80188c9814db4e6c620003c081076d3">jDeriv_comb_p</a>,<a class="code" href="namespaceBoscarino31__Mod.html#a4b597dec754853fe99f9ef0c23894dc6">iDeriv_comb_p</a>,j_perm,j_perm,1)
<a name="l00305"></a>00305         call <a class="code" href="namespaceunary__mod.html#ad981e96208abed6b51f14cda0410b0f5">csort</a>(vecl,<a class="code" href="namespaceBoscarino31__Mod.html#a711c0293fded4a1a022d6cae8cc33c2c">Deriv_comb_p</a>,<a class="code" href="namespaceBoscarino31__Mod.html#ae80188c9814db4e6c620003c081076d3">jDeriv_comb_p</a>,<a class="code" href="namespaceBoscarino31__Mod.html#a4b597dec754853fe99f9ef0c23894dc6">iDeriv_comb_p</a>,iwork,.true.)           
<a name="l00306"></a>00306    
<a name="l00307"></a>00307       <span class="keyword">endif</span>
<a name="l00308"></a>00308       
<a name="l00309"></a>00309  <span class="comment">! get dudt     </span>
<a name="l00310"></a>00310       call <a class="code" href="namespacematvec__module.html#a1f3669ca263f13c00625724a4add11ea">amux</a>(vecl,u,dudt_source,<a class="code" href="namespaceBoscarino31__Mod.html#afb8a2536db81b82cdd423dcd8a51cded">Source_p</a>,    <a class="code" href="namespaceBoscarino31__Mod.html#a07cc77f584e047fd4a9c846ed74c348d">jSource_p</a>,    <a class="code" href="namespaceBoscarino31__Mod.html#aa3b79880eae513aa43861d6caca177fe">iSource_p</a>    )
<a name="l00311"></a>00311       call <a class="code" href="namespacematvec__module.html#a1f3669ca263f13c00625724a4add11ea">amux</a>(vecl,u,dudt_D1,    <a class="code" href="namespaceBoscarino31__Mod.html#a711c0293fded4a1a022d6cae8cc33c2c">Deriv_comb_p</a>,<a class="code" href="namespaceBoscarino31__Mod.html#ae80188c9814db4e6c620003c081076d3">jDeriv_comb_p</a>,<a class="code" href="namespaceBoscarino31__Mod.html#a4b597dec754853fe99f9ef0c23894dc6">iDeriv_comb_p</a>)                 
<a name="l00312"></a>00312 
<a name="l00313"></a>00313       <span class="keyword">if</span> (sum(ierr)/=0) <span class="keyword">then</span> <span class="comment">! Catch errors</span>
<a name="l00314"></a>00314         print*,<span class="stringliteral">&apos;Error building dudt&apos;</span>
<a name="l00315"></a>00315         stop
<a name="l00316"></a>00316       <span class="keyword">endif</span>
<a name="l00317"></a>00317   
<a name="l00318"></a>00318 <span class="keyword">      end subroutine Bosc_dUdt</span>
<a name="l00319"></a>00319 <span class="comment">!==============================================================================</span>
<a name="l00320"></a><a class="code" href="namespaceBoscarino31__Mod.html#a879eecc4a61be972f3b34b7f121a57f0">00320</a>       <span class="keyword">subroutine </span><a class="code" href="namespaceBoscarino31__Mod.html#a879eecc4a61be972f3b34b7f121a57f0">Bosc_Jac</a>(dt,akk,a,ja,ia)
<a name="l00321"></a>00321       
<a name="l00322"></a>00322       use <span class="keywordflow">unary_mod</span>,         only: aplsca
<a name="l00323"></a>00323       use <span class="keywordflow">Jacobian_CSR_Mod</span>,  only: iaJac, jaJac,  aJac
<a name="l00324"></a>00324      
<a name="l00325"></a>00325       <span class="keywordtype">real(wp)</span>,                  <span class="keywordtype">intent(in)</span> :: dt,akk
<a name="l00326"></a>00326       <span class="keywordtype">real(wp)</span>, <span class="keywordtype">dimension(:)</span>,    <span class="keywordtype">intent(in)</span> :: a
<a name="l00327"></a>00327       <span class="keywordtype">integer</span>,  <span class="keywordtype">dimension(:)</span>,    <span class="keywordtype">intent(in)</span> :: ja,ia
<a name="l00328"></a>00328       
<a name="l00329"></a>00329       <span class="keywordtype">integer</span>,  <span class="keywordtype">dimension(vecl)             </span>:: iw
<a name="l00330"></a>00330       <span class="keywordtype">real(wp)</span>, dimension(size(a)+vecl/2)   :: wrk
<a name="l00331"></a>00331       <span class="keywordtype">integer</span>,  dimension(size(a)+vecl/2)   :: jwrk
<a name="l00332"></a>00332       <span class="keywordtype">integer</span>,  <span class="keywordtype">dimension(vecl+1)           </span>:: iwrk      
<a name="l00333"></a>00333       
<a name="l00334"></a>00334       
<a name="l00335"></a>00335       wrk=-akk*dt*a   
<a name="l00336"></a>00336       jwrk(:<span class="keyword">size</span>(ja))=ja
<a name="l00337"></a>00337       jwrk(<span class="keyword">size</span>(ja)+1:)=0
<a name="l00338"></a>00338       iwrk=ia
<a name="l00339"></a>00339 
<a name="l00340"></a>00340       call <a class="code" href="namespaceunary__mod.html#a74f52765deb59280ca3f1b308a7a3bfb">aplsca</a>(vecl,wrk,jwrk,iwrk,1.0_wp,iw)      
<a name="l00341"></a>00341 
<a name="l00342"></a>00342       <a class="code" href="namespaceJacobian__CSR__Mod.html#a94d69662ef031c9f945e105441d48c02">iaJac</a>=iwrk
<a name="l00343"></a>00343       <a class="code" href="namespaceJacobian__CSR__Mod.html#a5926dc41c54f00cbd2cc669cc175665b">jaJac</a>=jwrk
<a name="l00344"></a>00344       <a class="code" href="namespaceJacobian__CSR__Mod.html#a7f4fdf9a3cd9df4f89b43e74e69f16e5">aJac</a> = wrk
<a name="l00345"></a>00345       
<a name="l00346"></a>00346 <span class="keyword">      end subroutine Bosc_Jac      </span>
<a name="l00347"></a>00347 <span class="comment">!==============================================================================</span>
<a name="l00348"></a>00348 <span class="keyword">      end module Boscarino31_mod</span>
</pre></div></div>
<hr size="1"/><address style="text-align: right;"><small>Generated on 25 Jul 2016 for Doxygen Fortran Example by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
